---
import Base from './Base.astro';
import SummaNav from '../components/SummaNav.astro';

interface Props {
  title: string;
  description?: string;
  currentPart: string;
  currentQuestion?: number;
}

const { title, description, currentPart, currentQuestion } = Astro.props;
---

<Base title={title} description={description}>
  <SummaNav currentPart={currentPart} currentQuestion={currentQuestion} />

  <article class="summa-content">
    <slot />
  </article>

  <style>
    .summa-content {
      background-color: var(--color-bg-card);
      padding: 2rem;
      border-radius: 8px;
      border: 1px solid var(--color-border);
      box-shadow: 0 2px 8px var(--color-shadow);
    }

    @media (max-width: 600px) {
      .summa-content {
        padding: 1rem;
        border-radius: 0;
        border-left: none;
        border-right: none;
        margin: 0 -1rem;
      }
    }

    /* Typography improvements */
    .summa-content :global(h1),
    .summa-content :global(h2),
    .summa-content :global(h3),
    .summa-content :global(h4) {
      font-family: var(--font-heading);
      color: var(--color-text);
      text-align: center;
      margin-bottom: 1rem;
      letter-spacing: 0.02em;
    }

    .summa-content :global(h1) {
      font-size: 1.75rem;
      font-weight: 600;
      color: var(--color-accent);
      margin-top: 1rem;
    }

    .summa-content :global(h2) {
      font-size: 1.5rem;
      font-weight: 500;
      border-bottom: 1px solid var(--color-border);
      padding-bottom: 0.5rem;
    }

    .summa-content :global(h3) {
      font-size: 1.25rem;
      font-weight: 500;
      color: var(--color-burgundy);
      margin-top: 2rem;
    }

    /* Bilingual table styling */
    .summa-content :global(table) {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5rem 0;
      table-layout: fixed;
    }

    .summa-content :global(table tr) {
      border-bottom: 1px solid var(--color-border-light);
    }

    .summa-content :global(table tr:last-child) {
      border-bottom: none;
    }

    /* Two-column layout: Latin left, English right */
    .summa-content :global(td) {
      vertical-align: top;
      padding: 1rem 1.25rem;
      width: 50%;
      line-height: 1.8;
    }

    /* Latin column (left) */
    .summa-content :global(td:first-child) {
      font-style: italic;
      color: var(--color-text-muted);
      border-right: 2px solid var(--color-border);
      padding-right: 1.5rem;
    }

    /* English column (right) */
    .summa-content :global(td:last-child) {
      padding-left: 1.5rem;
    }

    /* Add column headers via CSS */
    .summa-content :global(table:first-of-type tr:first-child td:first-child::before) {
      content: 'LATIN';
      display: block;
      font-family: var(--font-heading);
      font-size: 0.7rem;
      font-style: normal;
      font-weight: 600;
      letter-spacing: 0.1em;
      color: var(--color-accent);
      margin-bottom: 0.75rem;
      opacity: 0.8;
    }

    .summa-content :global(table:first-of-type tr:first-child td:last-child::before) {
      content: 'ENGLISH';
      display: block;
      font-family: var(--font-heading);
      font-size: 0.7rem;
      font-weight: 600;
      letter-spacing: 0.1em;
      color: var(--color-accent);
      margin-bottom: 0.75rem;
      opacity: 0.8;
    }

    /* Bold text styling (Objections, Replies, etc.) */
    .summa-content :global(b),
    .summa-content :global(strong) {
      font-weight: 600;
      color: var(--color-text);
    }

    .summa-content :global(i b),
    .summa-content :global(b i) {
      font-family: var(--font-heading);
      font-size: 0.95rem;
      color: var(--color-burgundy);
    }

    /* Links */
    .summa-content :global(a) {
      color: var(--color-accent);
      text-decoration: none;
      transition: color var(--transition-fast);
    }

    .summa-content :global(a:hover) {
      color: var(--color-accent-hover);
      text-decoration: underline;
    }

    /* Navigation blocks (right-aligned navigation in original) */
    .summa-content :global(p[align="right"]),
    .summa-content :global(p[align="Right"]) {
      font-family: var(--font-sans);
      font-size: 0.8rem;
      background: var(--color-bg-alt);
      padding: 0.75rem 1rem;
      border-radius: 6px;
      margin: 1.5rem 0;
      text-align: right !important;
      border: 1px solid var(--color-border-light);
    }

    .summa-content :global(p[align="right"] a),
    .summa-content :global(p[align="Right"] a) {
      color: var(--color-navy);
      padding: 0.15rem 0.35rem;
      border-radius: 3px;
      transition: all var(--transition-fast);
    }

    .summa-content :global(p[align="right"] a:hover),
    .summa-content :global(p[align="Right"] a:hover) {
      background: var(--color-highlight);
      text-decoration: none;
    }

    /* Horizontal rules */
    .summa-content :global(hr) {
      border: none;
      height: 1px;
      background: linear-gradient(to right, transparent, var(--color-border), transparent);
      margin: 2rem 0;
    }

    /* Center blocks */
    .summa-content :global(center) {
      margin: 1rem 0;
      font-style: italic;
      color: var(--color-text-muted);
    }

    /* Font size overrides */
    .summa-content :global(font[size="-1"]) {
      font-size: 0.85rem;
    }

    .summa-content :global(font[size="-2"]) {
      font-size: 0.75rem;
    }

    .summa-content :global(font) {
      color: inherit !important;
    }

    /* Small text */
    .summa-content :global(small) {
      font-size: 0.875rem;
      color: var(--color-text-muted);
    }

    /* Responsive: Stack columns on mobile */
    @media (max-width: 768px) {
      .summa-content :global(table) {
        display: block;
      }

      .summa-content :global(tbody) {
        display: block;
      }

      .summa-content :global(tr) {
        display: block;
        margin-bottom: 1.5rem;
        padding-bottom: 1.5rem;
        border-bottom: 1px solid var(--color-border);
      }

      .summa-content :global(tr:last-child) {
        margin-bottom: 0;
        padding-bottom: 0;
        border-bottom: none;
      }

      .summa-content :global(td) {
        display: block;
        width: 100% !important;
        padding: 0.75rem 0;
        border-right: none !important;
      }

      .summa-content :global(td:first-child) {
        padding-right: 0;
        padding-bottom: 1rem;
        margin-bottom: 1rem;
        border-bottom: 1px dashed var(--color-border-light);
      }

      .summa-content :global(td:last-child) {
        padding-left: 0;
      }

      /* Mobile column labels */
      .summa-content :global(td:first-child::before) {
        content: 'LATIN';
        display: block;
        font-family: var(--font-heading);
        font-size: 0.65rem;
        font-style: normal;
        font-weight: 600;
        letter-spacing: 0.1em;
        color: var(--color-accent);
        margin-bottom: 0.5rem;
      }

      .summa-content :global(td:last-child::before) {
        content: 'ENGLISH';
        display: block;
        font-family: var(--font-heading);
        font-size: 0.65rem;
        font-weight: 600;
        letter-spacing: 0.1em;
        color: var(--color-accent);
        margin-bottom: 0.5rem;
      }

      .summa-content :global(table:first-of-type tr:first-child td:first-child::before),
      .summa-content :global(table:first-of-type tr:first-child td:last-child::before) {
        display: block;
      }

      .summa-content :global(p[align="right"]),
      .summa-content :global(p[align="Right"]) {
        font-size: 0.7rem;
        padding: 0.5rem 0.75rem;
      }
    }

    /* Dark mode adjustments */
    [data-theme="dark"] .summa-content {
      background-color: var(--color-bg-card);
    }

    [data-theme="dark"] .summa-content :global(td:first-child) {
      color: var(--color-text-muted);
      border-right-color: var(--color-border);
    }

    [data-theme="dark"] .summa-content :global(p[align="right"]),
    [data-theme="dark"] .summa-content :global(p[align="Right"]) {
      background: var(--color-bg-alt);
      border-color: var(--color-border);
    }

    [data-theme="dark"] .summa-content :global(font) {
      color: inherit !important;
    }

    /* Print styles */
    @media print {
      .summa-content {
        padding: 0;
        border: none;
        box-shadow: none;
      }

      .summa-content :global(p[align="right"]),
      .summa-content :global(p[align="Right"]) {
        display: none;
      }

      .summa-content :global(td:first-child) {
        border-right: 1px solid #ccc;
      }
    }
  </style>
</Base>
